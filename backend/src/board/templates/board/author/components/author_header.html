{% load static %}
{% load island %}
{% load resource %}

<div class="relative overflow-hidden">
    {# Cover Image Section #}
    {% if author.profile.cover %}
    <div class="relative w-full h-64 sm:h-80 md:h-100 overflow-hidden">
        <img
            src="{{ author.profile.cover.url }}"
            alt="{{ author.username }} cover"
            class="w-full h-full object-cover"
        />
        <div class="absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-white"></div>
    </div>
    {% endif %}

    <div class="relative flex flex-col items-center text-center {% if author.profile.cover %}-mt-16 sm:-mt-20{% else %}pt-12{% endif %} px-4 sm:px-6 pb-12 sm:pb-16 max-w-4xl mx-auto">
        <div class="relative group mb-6 sm:mb-8">
            {% if author.profile.avatar %}
            <img class="relative w-28 h-28 sm:w-32 sm:h-32 md:w-40 md:h-40 rounded-full object-cover ring-4 ring-white shadow-[0_8px_30px_rgba(0,0,0,0.12)] transition-all duration-500 group-hover:scale-105 group-hover:shadow-[0_20px_40px_rgba(0,0,0,0.16)]" src="{{ author.profile.avatar.url }}" alt="{{ author.username }}">
            {% else %}
            <div class="relative w-28 h-28 sm:w-32 sm:h-32 md:w-40 md:h-40 rounded-full ring-4 ring-white shadow-[0_8px_30px_rgba(0,0,0,0.12)] transition-all duration-500 group-hover:scale-105 group-hover:shadow-[0_20px_40px_rgba(0,0,0,0.16)] bg-black flex items-center justify-center text-5xl sm:text-6xl font-bold text-white uppercase">
                {{ author.username|slice:':1' }}
            </div>
            {% endif %}
        </div>

        <h1 class="text-2xl font-bold text-gray-900 mb-2 tracking-tight">
            {{ author.username }}
        </h1>

        {% if author.profile.bio %}
        <p class="text-md text-gray-500 max-w-2xl mx-auto mb-6 leading-relaxed px-4 font-medium">
            {{ author.profile.bio }}
        </p>
        {% endif %}

        {% if author.profile.homepage %}
        <div class="mb-8">
            <a href="{{ author.profile.homepage }}" target="_blank"
               class="inline-flex items-center gap-2 px-5 py-2.5 bg-white border border-gray-200 rounded-full
                      text-gray-600 hover:text-black hover:border-gray-400 hover:shadow-md
                      transition-all duration-300 text-sm font-semibold group">
                <i class="fas fa-link text-xs text-gray-400 group-hover:text-black transition-colors"></i>
                <span>
                    {% if 'https://' in author.profile.homepage %}
                        {{ author.profile.homepage|slice:"8:"|truncatechars:30 }}
                    {% elif 'http://' in author.profile.homepage %}
                        {{ author.profile.homepage|slice:"7:"|truncatechars:30 }}
                    {% else %}
                        {{ author.profile.homepage|truncatechars:30 }}
                    {% endif %}
                </span>
            </a>
        </div>
        {% endif %}

        {% with author.profile.collect_social as social_links %}
        {% if social_links %}
        <div class="flex gap-3 flex-wrap justify-center max-w-lg mx-auto">
            {% for social in social_links %}
            <a href="{{ social.value }}" target="_blank"
               class="w-10 h-10 sm:w-11 sm:h-11 rounded-full bg-white border border-gray-200
                      flex items-center justify-center text-gray-500
                      hover:bg-black hover:text-white hover:border-black hover:shadow-lg hover:-translate-y-1
                      transition-all duration-300"
               title="{{ social.name }}">
                {% if social.name|lower == 'github' %}
                    <i class="fab fa-github text-lg"></i>
                {% elif social.name|lower == 'twitter' or social.name|lower == 'x' %}
                    <i class="fab fa-twitter text-lg"></i>
                {% elif social.name|lower == 'facebook' %}
                    <i class="fab fa-facebook-f text-lg"></i>
                {% elif social.name|lower == 'instagram' %}
                    <i class="fab fa-instagram text-lg"></i>
                {% elif social.name|lower == 'linkedin' %}
                    <i class="fab fa-linkedin-in text-lg"></i>
                {% elif social.name|lower == 'youtube' %}
                    <i class="fab fa-youtube text-lg"></i>
                {% elif social.name|lower == 'tiktok' %}
                    <i class="fab fa-tiktok text-lg"></i>
                {% elif social.name|lower == 'discord' %}
                    <i class="fab fa-discord text-lg"></i>
                {% else %}
                    <i class="fas fa-link text-lg"></i>
                {% endif %}
            </a>
            {% endfor %}
        </div>
        {% elif request.user == author %}
        <a href="/settings/social-links"
           class="inline-flex items-center gap-2 px-4 py-2 rounded-full border border-dashed border-gray-300
                  text-sm text-gray-400 hover:text-gray-600 hover:border-gray-400
                  transition-all duration-200">
            <i class="fas fa-plus text-xs"></i>
            <span>소셜 링크 추가</span>
        </a>
        {% endif %}
        {% endwith %}
    </div>
</div>
