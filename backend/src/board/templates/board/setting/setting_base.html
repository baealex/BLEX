{% extends 'board/base.html' %}
{% load static %}
{% load island %}

{% block title %}{% block setting_title %}Settings{% endblock %} | BLEX{% endblock %}

{% block content %}
<div x-data="{ settingsMenuOpen: false }">
    <!-- Mobile Header -->
    <div class="xl:hidden mb-6">
        <div class="bg-white/80 backdrop-blur-xl border-b border-gray-200/80 px-4 py-3 flex items-center justify-between">
            <button @click="settingsMenuOpen = !settingsMenuOpen"
                    class="w-10 h-10 flex items-center justify-center rounded-full hover:bg-black/5 active:bg-black/10 transition-colors">
                <i class="fas fa-bars text-gray-900"></i>
            </button>
            <h1 class="text-lg font-bold text-gray-900">설정</h1>
            <div class="w-10"></div> <!-- Spacer -->
        </div>
    </div>

    <!-- Mobile Drawer Overlay -->
    <div x-show="settingsMenuOpen"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         @click="settingsMenuOpen = false"
         class="xl:hidden fixed inset-0 bg-black/20 backdrop-blur-sm z-40"
         x-cloak></div>

    <!-- Mobile Drawer -->
    <nav x-show="settingsMenuOpen"
         x-transition:enter="transition ease-out duration-300 transform"
         x-transition:enter-start="-translate-x-full"
         x-transition:enter-end="translate-x-0"
         x-transition:leave="transition ease-in duration-200 transform"
         x-transition:leave-start="translate-x-0"
         x-transition:leave-end="-translate-x-full"
         class="xl:hidden fixed top-0 left-0 bottom-0 w-[280px] bg-white shadow-2xl z-50 overflow-y-auto"
         x-cloak>
        
        <div class="p-6">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-2xl font-bold text-gray-900 tracking-tight">설정</h2>
                <button @click="settingsMenuOpen = false"
                        class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors">
                    <i class="fas fa-times text-gray-500"></i>
                </button>
            </div>

            <div class="space-y-8">
                <!-- Basic Settings -->
                <div>
                    <h3 class="px-4 mb-2 text-xs font-bold text-gray-400 uppercase tracking-wider">일반</h3>
                    <ul class="space-y-1">
                        <li>
                            <a href="{% url 'setting_notify' %}"
                               class="flex items-center px-4 py-3 rounded-xl transition-all duration-200
                                {% if active == 'notify' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                <i class="fas fa-bell w-6 text-center mr-3 {% if active == 'notify' %}text-gray-900{% else %}text-gray-400{% endif %}"></i>
                                <span>알림</span>
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'setting_account' %}"
                               class="flex items-center px-4 py-3 rounded-xl transition-all duration-200
                                {% if active == 'account' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                <i class="fas fa-user-cog w-6 text-center mr-3 {% if active == 'account' %}text-gray-900{% else %}text-gray-400{% endif %}"></i>
                                <span>계정</span>
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'setting_profile' %}"
                               class="flex items-center px-4 py-3 rounded-xl transition-all duration-200
                                {% if active == 'profile' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                <i class="fas fa-user w-6 text-center mr-3 {% if active == 'profile' %}text-gray-900{% else %}text-gray-400{% endif %}"></i>
                                <span>프로필</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Content Management -->
                {% if user.profile.is_editor %}
                <div>
                    <h3 class="px-4 mb-2 text-xs font-bold text-gray-400 uppercase tracking-wider">에디터</h3>
                    <ul class="space-y-1">
                        <li>
                            <a href="{% url 'setting_series' %}"
                               class="flex items-center px-4 py-3 rounded-xl transition-all duration-200
                                {% if active == 'series' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                <i class="fas fa-layer-group w-6 text-center mr-3 {% if active == 'series' %}text-gray-900{% else %}text-gray-400{% endif %}"></i>
                                <span>시리즈</span>
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'setting_posts' %}"
                               class="flex items-center px-4 py-3 rounded-xl transition-all duration-200
                                {% if active == 'posts' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                <i class="fas fa-file-alt w-6 text-center mr-3 {% if active == 'posts' %}text-gray-900{% else %}text-gray-400{% endif %}"></i>
                                <span>포스트</span>
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'setting_temp_posts' %}"
                               class="flex items-center px-4 py-3 rounded-xl transition-all duration-200
                                {% if active == 'temp_posts' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                <i class="fas fa-save w-6 text-center mr-3 {% if active == 'temp_posts' %}text-gray-900{% else %}text-gray-400{% endif %}"></i>
                                <span>임시글</span>
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'setting_forms' %}"
                               class="flex items-center px-4 py-3 rounded-xl transition-all duration-200
                                {% if active == 'forms' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                <i class="fas fa-align-left w-6 text-center mr-3 {% if active == 'forms' %}text-gray-900{% else %}text-gray-400{% endif %}"></i>
                                <span>서식</span>
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'setting_banners' %}"
                               class="flex items-center px-4 py-3 rounded-xl transition-all duration-200
                                {% if active == 'banners' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                <i class="fas fa-rectangle-ad w-6 text-center mr-3 {% if active == 'banners' %}text-gray-900{% else %}text-gray-400{% endif %}"></i>
                                <span>배너</span>
                            </a>
                        </li>
                    </ul>
                </div>
                {% endif %}

                <div>
                    <h3 class="px-4 mb-2 text-xs font-bold text-gray-400 uppercase tracking-wider">고급</h3>
                    <ul class="space-y-1">
                        <li>
                            <a href="{% url 'setting_integration' %}"
                               class="flex items-center px-4 py-3 rounded-xl transition-all duration-200
                                {% if active == 'integration' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                <i class="fas fa-plug w-6 text-center mr-3 {% if active == 'integration' %}text-gray-900{% else %}text-gray-400{% endif %}"></i>
                                <span>연동</span>
                            </a>
                        </li>
                    </ul>
                </div>

                {% if request.user.is_staff %}
                <div>
                    <h3 class="px-4 mb-2 text-xs font-bold text-gray-400 uppercase tracking-wider">관리자</h3>
                    <ul class="space-y-1">
                        <li>
                            <a href="{% url 'admin:index' %}"
                               class="flex items-center px-4 py-3 rounded-xl transition-all duration-200
                                {% if active == 'staff' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                <i class="fas fa-shield-alt w-6 text-center mr-3 {% if active == 'staff' %}text-gray-900{% else %}text-gray-400{% endif %}"></i>
                                <span>관리자 패널</span>
                            </a>
                        </li>
                    </ul>
                </div>
                {% endif %}
            </div>
        </div>
    </nav>

    <!-- Desktop Layout -->
    <div class="max-w-7xl w-full mx-auto px-4 sm:px-6">
        <div class="flex flex-col xl:flex-row gap-8 xl:gap-12">
            <aside class="hidden xl:block w-64 flex-shrink-0 mt-8">
                <div class="sticky top-24">
                    <h2 class="text-2xl font-bold text-gray-900 tracking-tight mb-8 px-4">설정</h2>
                    
                    <nav class="space-y-8">
                        <div>
                            <h3 class="px-4 mb-3 text-xs font-bold text-gray-400 uppercase tracking-wider">일반</h3>
                            <ul class="space-y-1">
                                <li>
                                    <a href="{% url 'setting_notify' %}"
                                       class="flex items-center px-4 py-2.5 rounded-xl transition-all duration-200 group
                                        {% if active == 'notify' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                        <i class="fas fa-bell w-6 text-center mr-3 transition-colors {% if active == 'notify' %}text-gray-900{% else %}text-gray-400 group-hover:text-gray-600{% endif %}"></i>
                                        <span>알림</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="{% url 'setting_account' %}"
                                       class="flex items-center px-4 py-2.5 rounded-xl transition-all duration-200 group
                                        {% if active == 'account' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                        <i class="fas fa-user-cog w-6 text-center mr-3 transition-colors {% if active == 'account' %}text-gray-900{% else %}text-gray-400 group-hover:text-gray-600{% endif %}"></i>
                                        <span>계정</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="{% url 'setting_profile' %}"
                                       class="flex items-center px-4 py-2.5 rounded-xl transition-all duration-200 group
                                        {% if active == 'profile' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                        <i class="fas fa-user w-6 text-center mr-3 transition-colors {% if active == 'profile' %}text-gray-900{% else %}text-gray-400 group-hover:text-gray-600{% endif %}"></i>
                                        <span>프로필</span>
                                    </a>
                                </li>
                            </ul>
                        </div>

                        {% if user.profile.is_editor %}
                        <div>
                            <h3 class="px-4 mb-3 text-xs font-bold text-gray-400 uppercase tracking-wider">에디터</h3>
                            <ul class="space-y-1">
                                <li>
                                    <a href="{% url 'setting_series' %}"
                                       class="flex items-center px-4 py-2.5 rounded-xl transition-all duration-200 group
                                        {% if active == 'series' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                        <i class="fas fa-layer-group w-6 text-center mr-3 transition-colors {% if active == 'series' %}text-gray-900{% else %}text-gray-400 group-hover:text-gray-600{% endif %}"></i>
                                        <span>시리즈</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="{% url 'setting_posts' %}"
                                       class="flex items-center px-4 py-2.5 rounded-xl transition-all duration-200 group
                                        {% if active == 'posts' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                        <i class="fas fa-file-alt w-6 text-center mr-3 transition-colors {% if active == 'posts' %}text-gray-900{% else %}text-gray-400 group-hover:text-gray-600{% endif %}"></i>
                                        <span>포스트</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="{% url 'setting_temp_posts' %}"
                                       class="flex items-center px-4 py-2.5 rounded-xl transition-all duration-200 group
                                        {% if active == 'temp_posts' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                        <i class="fas fa-save w-6 text-center mr-3 transition-colors {% if active == 'temp_posts' %}text-gray-900{% else %}text-gray-400 group-hover:text-gray-600{% endif %}"></i>
                                        <span>임시글</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="{% url 'setting_forms' %}"
                                       class="flex items-center px-4 py-2.5 rounded-xl transition-all duration-200 group
                                        {% if active == 'forms' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                        <i class="fas fa-align-left w-6 text-center mr-3 transition-colors {% if active == 'forms' %}text-gray-900{% else %}text-gray-400 group-hover:text-gray-600{% endif %}"></i>
                                        <span>서식</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="{% url 'setting_banners' %}"
                                       class="flex items-center px-4 py-2.5 rounded-xl transition-all duration-200 group
                                        {% if active == 'banners' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                        <i class="fas fa-rectangle-ad w-6 text-center mr-3 transition-colors {% if active == 'banners' %}text-gray-900{% else %}text-gray-400 group-hover:text-gray-600{% endif %}"></i>
                                        <span>배너</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                        {% endif %}

                        <div>
                            <h3 class="px-4 mb-3 text-xs font-bold text-gray-400 uppercase tracking-wider">고급</h3>
                            <ul class="space-y-1">
                                <li>
                                    <a href="{% url 'setting_integration' %}"
                                       class="flex items-center px-4 py-2.5 rounded-xl transition-all duration-200 group
                                        {% if active == 'integration' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                        <i class="fas fa-plug w-6 text-center mr-3 transition-colors {% if active == 'integration' %}text-gray-900{% else %}text-gray-400 group-hover:text-gray-600{% endif %}"></i>
                                        <span>연동</span>
                                    </a>
                                </li>
                            </ul>
                        </div>

                        {% if request.user.is_staff %}
                        <div>
                            <h3 class="px-4 mb-3 text-xs font-bold text-gray-400 uppercase tracking-wider">관리자</h3>
                            <ul class="space-y-1">
                                <li>
                                    <a href="{% url 'admin:index' %}"
                                       class="flex items-center px-4 py-2.5 rounded-xl transition-all duration-200 group
                                        {% if active == 'staff' %}bg-gray-100 text-gray-900 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900 font-medium{% endif %}">
                                        <i class="fas fa-shield-alt w-6 text-center mr-3 transition-colors {% if active == 'staff' %}text-gray-900{% else %}text-gray-400 group-hover:text-gray-600{% endif %}"></i>
                                        <span>관리자 패널</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                        {% endif %}
                    </nav>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="flex-1 min-w-0 py-6">
                {% block setting_content %}{% endblock %}
            </main>
        </div>
    </div>
</div>
{% endblock %}
