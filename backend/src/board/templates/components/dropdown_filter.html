{% comment %}
Dropdown Filter Component
Parameters:
- options: A list of dictionaries, where each dictionary has 'value' and 'label'.
- param_name: The URL parameter name to update.
- current_value: The currently selected value.
- default_label: The label to show when no value is selected.
{% endcomment %}

<div class="relative" x-data="dropdown_filter">
    <button @click="open = !open" :aria-expanded="open" aria-haspopup="listbox" class="flex items-center justify-between w-full sm:w-48 px-4 py-2 bg-surface-elevated ring-1 ring-line/60 rounded-2xl text-sm font-medium text-content-secondary hover:bg-surface-subtle focus:outline-none focus:ring-2 focus:ring-line-strong/70">
        <span class="truncate">
            {% for option in options %}
                {% if option.value == current_value %}{{ option.label }}{% endif %}
            {% endfor %}
            {% if not current_value or current_value == '' %}{{ default_label }}{% endif %}
        </span>
        <i class="fas fa-chevron-down text-xs ml-2 transition-transform duration-150" :class="{ 'transform rotate-180': open }"></i>
    </button>
    <div
        x-show="open"
        @click.away="open = false"
        role="listbox"
        class="absolute left-0 sm:right-0 mt-2 w-full sm:w-full bg-surface-elevated rounded-lg shadow-lg py-1 z-50 ring-1 ring-line/60 max-h-60 overflow-y-auto"
        x-transition:enter="transition ease-out duration-150"
        x-transition:enter-start="transform opacity-0 scale-95"
        x-transition:enter-end="transform opacity-100 scale-100"
        x-transition:leave="transition ease-in duration-150"
        x-transition:leave-start="transform opacity-100 scale-100"
        x-transition:leave-end="transform opacity-0 scale-95"
        style="display: none;"
    >
        {% for option in options %}
        <a href="#" role="option" {% if current_value|default:'' == option.value|default:'' %}aria-selected="true"{% endif %} @click.prevent="updateQueryParams('{{ param_name }}', '{{ option.value }}'); open = false" class="block px-4 py-3 text-sm text-content-secondary hover:bg-surface-subtle transition-colors duration-150 {% if current_value|default:'' == option.value|default:'' %}bg-surface-subtle text-content font-semibold{% endif %}">
            {{ option.label }}
        </a>
        {% endfor %}
    </div>
</div>
